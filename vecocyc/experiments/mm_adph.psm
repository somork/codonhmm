% mm_adph.psm
% S/ren M/rk
% 100721

:-['../lib/default.pl'].
data('../data/nc000913_2_v.dat').

% parameters:
values(transition(begin),[state(1)]).

values(transition(state(1),_,_,_),[state(1)]).

values(emission(_,_,_),[a,c,g,t]).
values(emission(_,_),[a,c,g,t]).
values(emission(_),[a,c,g,t]).

% ADPH:
values(adph,[s,g]).

adph(1,s,adph(1)).
adph(1,g,adph(2)).
adph(2,s,adph(2)).
adph(2,g,adph(3)).
adph(3,s,adph(3)).
adph(3,g,end).

% initiation:
model(Obs):-
        msw(transition(begin),NS),
        recursion(adph(1),NS,Obs).

% recursion:
recursion(adph(A),state(S),[Xi|[Yi|[Zi|R]]]):-
        msw(emission(S),Xi),
        msw(emission(S,Xi),Yi),
        msw(emission(S,Xi,Yi),Zi),
        msw(transition(state(S),Xi,Yi,Zi),NS),
        msw(adph,SG),
        adph(A,SG,NA),
        recursion(NA,NS,R).

% termination:
recursion(end,_,[]).


